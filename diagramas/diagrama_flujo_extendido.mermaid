%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#4a90d9', 'primaryTextColor': '#fff', 'primaryBorderColor': '#2c5282', 'lineColor': '#2c5282', 'secondaryColor': '#90cdf4', 'tertiaryColor': '#e2e8f0'}}}%%

flowchart TD
    subgraph INICIO["ğŸ“ ENTRADA"]
        A[("ğŸ· Dataset CSV<br/>Wine Quality White<br/>4,898 registros x 12 cols")]
    end

    subgraph FASE1["FASE 1: CARGA Y VALIDACIÃ“N"]
        B["ğŸ“¥ Cargar datos<br/>pandas.read_csv()"]
        C{"âœ… Validar<br/>>2000 registros<br/>>10 columnas"}
        D["ğŸ·ï¸ Identificar tipos<br/>NumÃ©ricas vs CategÃ³ricas"]
        E["ğŸ” Detectar duplicados<br/>937 encontrados"]
    end

    subgraph FASE2["FASE 2: CALIDAD DE DATOS"]
        F["ğŸ“Š AnÃ¡lisis nulos<br/>0% faltantes"]
        G["ğŸŒ¡ï¸ Heatmap<br/>valores faltantes"]
        H["ğŸ“‹ Crear categorÃ­as<br/>Baja/Media/Alta"]
    end

    subgraph FASE3["FASE 3: ESTADÃSTICAS"]
        I["ğŸ“ Descriptivas extendidas<br/>mean, std, var, IQR"]
        J["ğŸ“ˆ AsimetrÃ­a y Curtosis<br/>skew(), kurtosis()"]
        K["ğŸ“Š DistribuciÃ³n quality<br/>Frecuencias y %"]
    end

    subgraph FASE4["FASE 4: TESTS NORMALIDAD"]
        L["ğŸ§ª Shapiro-Wilk<br/>n < 5000"]
        M["ğŸ§ª D'Agostino-Pearson<br/>normaltest()"]
        N["ğŸ“‰ Q-Q Plots<br/>VerificaciÃ³n visual"]
    end

    subgraph FASE5["FASE 5: VISUALIZACIONES"]
        O["ğŸ“Š Histogramas + KDE"]
        P["ğŸ“¦ Boxplots<br/>con outliers"]
        Q["ğŸ» Violin plots<br/>por categorÃ­a"]
        R["ğŸ“Š Barras quality"]
    end

    subgraph FASE6["FASE 6: OUTLIERS"]
        S["ğŸ”¢ MÃ©todo IQR<br/>1,063 detectados"]
        T["ğŸ“ MÃ©todo Z-score<br/>|z| > 3"]
        U["ğŸ“‹ Top variables<br/>citric acid, chlorides"]
    end

    subgraph FASE7["FASE 7: CORRELACIONES"]
        V["ğŸ”— Pearson<br/>CorrelaciÃ³n lineal"]
        W["ğŸ”— Spearman<br/>CorrelaciÃ³n monotÃ³nica"]
        X["ğŸŒ¡ï¸ Dual heatmap"]
        Y["ğŸ† Top 10 correlaciones"]
        Z["ğŸ“Š Corr vs quality"]
    end

    subgraph FASE8["FASE 8: TESTS ESTADÃSTICOS"]
        AA["ğŸ“Š ANOVA<br/>F-test por grupos"]
        AB["ğŸ“Š Kruskal-Wallis<br/>Test no paramÃ©trico"]
        AC["âœ… Significancia<br/>p < 0.05"]
    end

    subgraph FASE9["FASE 9: PCA"]
        AD["âš™ï¸ StandardScaler<br/>NormalizaciÃ³n"]
        AE["ğŸ”„ PCA completo<br/>n_components=all"]
        AF["ğŸ“ˆ Scree plot<br/>Varianza explicada"]
        AG["ğŸ“Š Biplot<br/>Loadings"]
        AH["ğŸ“ Scatter PCA<br/>PC1 vs PC2"]
    end

    subgraph FASE10["FASE 10: CLUSTERING"]
        AI["ğŸ“ MÃ©todo del codo<br/>Inertia"]
        AJ["ğŸ“Š Silhouette Score<br/>Calidad clusters"]
        AK["ğŸ¯ K-Means<br/>k=4 clusters"]
        AL["ğŸ“‹ Perfiles<br/>de clusters"]
    end

    subgraph FASE11["FASE 11: MACHINE LEARNING"]
        AM["ğŸ”€ Train/Test Split<br/>80/20 estratificado"]
        AN["ğŸ¤– 5 Modelos:<br/>LR, RF, GB, KNN, DT"]
        AO["ğŸ“Š Cross-Validation<br/>5-fold"]
        AP["ğŸ“‹ MÃ©tricas<br/>Acc, Prec, Rec, F1"]
        AQ["ğŸ† Mejor: Random Forest<br/>67.55% accuracy"]
    end

    subgraph FASE12["FASE 12: FEATURE IMPORTANCE"]
        AR["ğŸ“Š Importancia RF<br/>feature_importances_"]
        AS["ğŸ† Top: alcohol<br/>11.65%"]
        AT["ğŸ“ˆ GrÃ¡fico barras<br/>ranking variables"]
    end

    subgraph FASE13["FASE 13: REGRESIÃ“N"]
        AU["ğŸ“ˆ Linear Regression"]
        AV["ğŸŒ² RF Regressor"]
        AW["ğŸ“‹ MÃ©tricas<br/>MSE, RMSE, MAE, RÂ²"]
        AX["ğŸ“Š Coeficientes<br/>interpretaciÃ³n"]
    end

    subgraph FASE14["FASE 14: CLAUDE API"]
        AY["ğŸ“ Compilar resumen<br/>completo anÃ¡lisis"]
        AZ["ğŸ¤– API Anthropic<br/>claude-sonnet-4"]
        BA["ğŸ“„ Reporte ejecutivo<br/>8 secciones"]
    end

    subgraph SALIDA["ğŸ“¤ SALIDAS"]
        BB[("ğŸ“Š 16 Visualizaciones<br/>outputs/")]
        BC[("ğŸ“„ Resumen anÃ¡lisis<br/>reports/")]
        BD[("ğŸ’¡ Insights Claude<br/>reports/")]
        BE[("ğŸ“‘ Reporte Final")]
    end

    A --> B
    B --> C
    C -->|âœ…| D
    D --> E
    E --> F
    F --> G
    G --> H
    H --> I
    I --> J
    J --> K
    K --> L
    L --> M
    M --> N
    N --> O
    O --> P
    P --> Q
    Q --> R
    R --> S
    S --> T
    T --> U
    U --> V
    V --> W
    W --> X
    X --> Y
    Y --> Z
    Z --> AA
    AA --> AB
    AB --> AC
    AC --> AD
    AD --> AE
    AE --> AF
    AF --> AG
    AG --> AH
    AH --> AI
    AI --> AJ
    AJ --> AK
    AK --> AL
    AL --> AM
    AM --> AN
    AN --> AO
    AO --> AP
    AP --> AQ
    AQ --> AR
    AR --> AS
    AS --> AT
    AT --> AU
    AU --> AV
    AV --> AW
    AW --> AX
    AX --> AY
    AY --> AZ
    AZ --> BA
    BA --> BB
    BA --> BC
    BA --> BD
    BD --> BE

    style A fill:#2c5282,color:#fff
    style BE fill:#276749,color:#fff
    style AZ fill:#9f7aea,color:#fff
    style AQ fill:#dd6b20,color:#fff
    style C fill:#38a169,color:#fff
